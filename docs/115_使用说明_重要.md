# ⚠️ 115网盘使用说明（重要）

> **更新日期**：2025-10-17  
> **重要变更**：扫码登录现在是纯Cookie模式，不会自动激活开放平台

## 🎯 正确的使用顺序

### 第一步：扫码登录（必须）

1. 进入 **115网盘设置页面**
2. **选择设备类型**（推荐：`115生活 - Android`）
3. 点击 **"扫码登录"** 按钮
4. 使用 **115 APP** 扫描二维码
5. 在APP中点击 **"确认登录"**
6. 等待页面提示 **"登录成功"**

✅ **此时您已获得有效的Cookie，可以使用所有基础功能！**

> 💡 **重要说明**：扫码登录现在是**纯Cookie模式**，即使您已经填写了AppID，扫码时也不会自动激活开放平台。这样设计是为了让用户有更清晰的控制权。

---

### 第二步：激活开放平台（可选，需要AppID）

⚠️ **前置条件**：必须先完成第一步的扫码登录！

如果您有115开放平台的AppID：

1. **确保已完成扫码登录**（能看到用户信息）
2. 在设置页面填写 **AppID**（例如：100195193）
3. 点击"保存"按钮
4. 点击 **"启用OPENAPI"** 开关
5. 系统会使用您的Cookie + AppID获取access_token
6. ✅ 激活成功后，您将获得更稳定的API权限

---

## ❌ 常见错误

### 错误1：直接点击"启用OPENAPI"

```
❌ 错误提示：登录凭证已过期，请重新扫码登录
```

**原因**：没有先扫码登录，或者Cookie已过期

**解决方案**：先完成第一步"扫码登录"

---

### 错误2：空间信息显示为 0B / 0B

**原因**：
- 115 API限流（最常见）
- Cookie已过期
- 刚登录，信息未刷新

**解决方案**：
1. 等待30秒后点击"刷新用户信息"
2. 如果还是0，重新扫码登录
3. 如果有AppID，激活OPENAPI后会更稳定

---

### 错误3：二维码扫不上

**可能原因**：
- 二维码已过期（5分钟有效期）
- 网络问题
- 使用了错误的APP

**解决方案**：
1. 关闭弹窗，重新点击"扫码登录"
2. 确保使用**115官方APP**（不是浏览器）
3. 检查网络连接

---

## 🔍 如何检查Cookie是否有效

在115设置页面：

1. 看 **"账号状态"** 区域
2. 如果显示用户信息（用户名、VIP等级），说明Cookie有效
3. 如果显示 **"未登录"**，需要重新扫码

或者点击 **"测试Cookie可用性"** 按钮（如果有）

---

## 📊 两种模式对比

### Cookie模式（方式一）

✅ **优点**：
- 简单快速，5分钟可用
- 不需要申请AppID
- 支持所有基础功能

❌ **缺点**：
- Cookie有效期约30天，需要定期重新登录
- API可能被限流
- 空间信息获取不稳定

**适用场景**：个人使用、快速测试

---

### OpenAPI模式（方式二）

✅ **优点**：
- 更稳定的API访问
- access_token可自动刷新
- 更高的请求配额
- 空间信息更准确

❌ **缺点**：
- 需要申请115开放平台AppID（白名单制）
- 必须先有Cookie才能激活
- access_token有效期2小时（但可刷新）

**适用场景**：生产环境、高频使用

---

## 🚀 推荐使用流程

### 新手用户

```
1. 扫码登录（获取Cookie）
   ↓
2. 直接使用（Cookie模式）
   ↓
3. Cookie过期后重新扫码
```

### 高级用户（有AppID）

```
1. 扫码登录（获取Cookie）
   ↓
2. 填写AppID
   ↓
3. 激活OPENAPI（获取Token）
   ↓
4. 长期稳定使用（Token自动刷新）
   ↓
5. 如果Token失效，回到步骤1
```

---

## 💡 最佳实践

1. **定期登录**：Cookie模式下，建议每2周重新扫码一次
2. **保存AppID**：如果有AppID，务必保存在配置中
3. **监控状态**：定期检查"账号状态"区域
4. **不要频繁调用API**：建议请求间隔≥1秒
5. **使用缓存**：用户信息会缓存30秒，无需频繁刷新

---

## 🆘 故障排查步骤

如果遇到任何问题，按以下顺序排查：

1. ✅ **检查Cookie是否有效**
   - 查看设置页面的账号状态
   - 如果无效，重新扫码登录

2. ✅ **检查网络连接**
   - 115是国内服务，通常不需要代理
   - 如果在国外，可能需要配置代理

3. ✅ **检查AppID配置**
   - 如果使用OPENAPI，确保AppID正确
   - 确保AppID已获得115官方授权

4. ✅ **查看日志**
   - Docker日志：`docker logs tmc-local`
   - 查找错误信息，了解具体原因

5. ✅ **重新开始**
   - 清除所有配置
   - 重新扫码登录
   - 重新激活OPENAPI（如果需要）

---

## 📞 需要帮助？

如果以上方法都无法解决问题，请提供：

1. 完整的错误信息
2. Docker日志（最后50行）
3. 115设置页面截图
4. 您的操作步骤

---

**文档版本**：v1.0  
**更新日期**：2025-10-17  
**状态**：✅ 最新

