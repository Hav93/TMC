# Test åˆ†æ”¯éƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

test åˆ†æ”¯æ˜¯ TMC çš„å¼€å‘æµ‹è¯•åˆ†æ”¯ï¼ŒåŒ…å«æœ€æ–°çš„åŠŸèƒ½å’Œæ”¹è¿›ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©ä½ å¿«é€Ÿéƒ¨ç½² test ç‰ˆæœ¬ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šä½¿ç”¨é»˜è®¤é…ç½®ï¼ˆæ¨èï¼‰

```bash
# 1. å…‹éš†ä»“åº“å¹¶åˆ‡æ¢åˆ° test åˆ†æ”¯
git clone https://github.com/Hav93/TMC.git
cd TMC
git checkout test

# 2. å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶
cp env.example .env

# 3. å¯åŠ¨æœåŠ¡ï¼ˆè‡ªåŠ¨ä½¿ç”¨ test é•œåƒï¼‰
docker-compose up -d

# 4. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### æ–¹å¼äºŒï¼šç›´æ¥æ‹‰å–é•œåƒ

```bash
# æ‹‰å– test ç‰ˆæœ¬é•œåƒ
docker pull hav93/tmc:test

# ä½¿ç”¨ docker run å¯åŠ¨
docker run -d \
  --name tmc-test \
  -p 9393:9393 \
  -v ./data:/app/data \
  -v ./sessions:/app/sessions \
  -v ./logs:/app/logs \
  -e TZ=Asia/Shanghai \
  hav93/tmc:test
```

## ğŸ”§ é…ç½®è¯´æ˜

### Docker æ ‡ç­¾é…ç½®

test åˆ†æ”¯çš„ `docker-compose.yml` é»˜è®¤ä½¿ç”¨ `test` æ ‡ç­¾ï¼Œä½ å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡åˆ‡æ¢ï¼š

```bash
# ä½¿ç”¨æµ‹è¯•ç‰ˆæœ¬ï¼ˆé»˜è®¤ï¼‰
docker-compose up -d

# ä½¿ç”¨ç¨³å®šç‰ˆæœ¬
DOCKER_TAG=latest docker-compose up -d

# ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬
DOCKER_TAG=v1.2.0 docker-compose up -d
```

### ç¯å¢ƒå˜é‡

åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®ï¼š

```env
# Docker é•œåƒæ ‡ç­¾
DOCKER_TAG=test

# åº”ç”¨ç«¯å£
APP_PORT=9393

# æ—¶åŒº
TZ=Asia/Shanghai

# å…¶ä»–é…ç½®...
```

## ğŸ“¦ ç‰ˆæœ¬å¯¹æ¯”

| ç‰ˆæœ¬ | é•œåƒæ ‡ç­¾ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|---------|------|---------|
| **Test** | `hav93/tmc:test` | æµ‹è¯•ç‰ˆæœ¬ï¼ŒåŒ…å«æœ€æ–°åŠŸèƒ½ | å¼€å‘æµ‹è¯•ã€åŠŸèƒ½é¢„è§ˆ |
| **Stable** | `hav93/tmc:latest` | ç¨³å®šç‰ˆæœ¬ï¼Œç»è¿‡å……åˆ†æµ‹è¯• | ç”Ÿäº§ç¯å¢ƒ |
| **Specific** | `hav93/tmc:v1.x.x` | ç‰¹å®šç‰ˆæœ¬ | éœ€è¦å›ºå®šç‰ˆæœ¬ |

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ•°æ®åº“å…¼å®¹æ€§

**é‡è¦ï¼štest åˆ†æ”¯ä¸ä¿è¯å‘åå…¼å®¹ï¼**

- âœ… **æ¨è**ï¼šå…¨æ–°éƒ¨ç½² test ç‰ˆæœ¬
- âš ï¸ **ä¸æ¨è**ï¼šä» stable ç‰ˆæœ¬å‡çº§åˆ° test ç‰ˆæœ¬
- ğŸ”„ å¦‚éœ€å‡çº§ï¼Œè¯·å…ˆå¤‡ä»½æ•°æ®ï¼š

```bash
# å¤‡ä»½æ•°æ®åº“
cp data/bot.db data/bot.db.backup

# å¤‡ä»½ä¼šè¯æ–‡ä»¶
cp -r sessions sessions.backup
```

### 2. æ•°æ®åº“é‡ç½®

å¦‚æœé‡åˆ°æ•°æ®åº“ç‰ˆæœ¬ä¸åŒ¹é…ï¼Œtest åˆ†æ”¯ä¼šæç¤ºåˆ é™¤æ•°æ®åº“ï¼š

```bash
# åœæ­¢å¹¶åˆ é™¤å®¹å™¨å’Œæ•°æ®å·
docker-compose down -v

# åˆ é™¤æ•°æ®åº“æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦ï¼‰
rm data/bot.db

# é‡æ–°å¯åŠ¨
docker-compose up -d
```

### 3. å®¹å™¨åç§°

test åˆ†æ”¯çš„å®¹å™¨åç§°é»˜è®¤ä¸º `tmc-test`ï¼Œä¸ç¨³å®šç‰ˆæœ¬çš„ `tmc-latest` åŒºåˆ†ï¼Œå¯ä»¥åœ¨åŒä¸€å°æœºå™¨ä¸ŠåŒæ—¶è¿è¡Œï¼ˆéœ€è¦ä¿®æ”¹ç«¯å£ï¼‰ã€‚

## ğŸ”„ æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬

```bash
# æ‹‰å–æœ€æ–°é•œåƒ
docker-compose pull

# é‡å¯å®¹å™¨
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—ç¡®è®¤å¯åŠ¨æˆåŠŸ
docker-compose logs -f
```

## ğŸ› æ•…éšœæ’æŸ¥

### å®¹å™¨æ— æ³•å¯åŠ¨

```bash
# æŸ¥çœ‹æ—¥å¿—
docker-compose logs tmc

# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker-compose ps

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose down
docker-compose up -d
```

### æ•°æ®åº“ç‰ˆæœ¬ä¸åŒ¹é…

```bash
# test åˆ†æ”¯ç­–ç•¥ï¼šåˆ é™¤æ—§æ•°æ®åº“ï¼Œé‡æ–°åˆ›å»º
docker-compose down -v
rm data/bot.db
docker-compose up -d
```

### ç«¯å£å†²çª

ä¿®æ”¹ `.env` æ–‡ä»¶ä¸­çš„ç«¯å£ï¼š

```env
APP_PORT=9394  # ä½¿ç”¨å…¶ä»–ç«¯å£
```

## ğŸ“Š å¥åº·æ£€æŸ¥

```bash
# æ£€æŸ¥å®¹å™¨å¥åº·çŠ¶æ€
docker-compose ps

# è®¿é—®å¥åº·æ£€æŸ¥æ¥å£
curl http://localhost:9393/api/health

# è®¿é—® Web ç•Œé¢
open http://localhost:9393
```

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [Test åˆ†æ”¯æ•°æ®åº“ç­–ç•¥](./TEST_BRANCH_DATABASE_STRATEGY.md)
- [å‡çº§åˆ° Test åˆ†æ”¯](./UPGRADE_TO_TEST_BRANCH.md)
- [æ¸…ç†æ€»ç»“](./CLEANUP_SUMMARY.md)
- [æœ¬åœ°å¼€å‘æŒ‡å—](../local-dev/README.md)

## ğŸ’¡ æœ€ä½³å®è·µ

1. **æµ‹è¯•ç¯å¢ƒ**ï¼šä½¿ç”¨ test åˆ†æ”¯ä½“éªŒæœ€æ–°åŠŸèƒ½
2. **ç”Ÿäº§ç¯å¢ƒ**ï¼šä½¿ç”¨ latest æ ‡ç­¾éƒ¨ç½²ç¨³å®šç‰ˆæœ¬
3. **æ•°æ®å¤‡ä»½**ï¼šå®šæœŸå¤‡ä»½ `data/` å’Œ `sessions/` ç›®å½•
4. **ç‰ˆæœ¬éš”ç¦»**ï¼štest å’Œ stable ç‰ˆæœ¬ä½¿ç”¨ä¸åŒçš„å®¹å™¨åç§°å’Œç«¯å£

## ğŸ†˜ è·å–å¸®åŠ©

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹ [Issues](https://github.com/Hav93/TMC/issues)
2. æäº¤æ–°çš„ Issueï¼ˆè¯·é™„ä¸Šæ—¥å¿—ï¼‰
3. æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£

---

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰

